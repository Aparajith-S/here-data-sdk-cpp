project(boost)
cmake_minimum_required(VERSION 3.2)

cmake_policy(SET CMP0026 OLD)

set(CMAKE_VERBOSE_MAKEFILE ON)

option(BOOST_ALL_NO_LIB OFF)
if(BOOST_ALL_NO_LIB)
    add_definitions(-DBOOST_ALL_NO_LIB)
endif()

if (WIN32)
    set(CMAKE_STATIC_LIBRARY_PREFIX "lib")
endif()

if (CMAKE_SYSTEM_NAME STREQUAL "QNX" OR ANDROID OR APPLE OR WIN32)
    message("Building static boost")
    set(BOOST_LINK_TYPE STATIC)
    set(BOOST_DEFINE_SUFFIX STATIC_LINK)
elseif (NOT DEFINED BOOST_LINK_TYPE OR NOT DEFINED BOOST_DEFINE_SUFFIX)
    set(BOOST_LINK_TYPE SHARED)
    set(BOOST_DEFINE_SUFFIX DYN_LINK)
endif()

##
## boost_program_options
##
set(ANDROID_BUILD_SYSTEM $ENV{ANDROID_BUILD_SYSTEM})
if(ANDROID_BUILD_SYSTEM STREQUAL "visual-studio")
    set(CROSS_COMPILING_ANDROID_ON_WINDOWS "TRUE")
endif()
aux_source_directory(libs/program_options/src PROGRAM_OPTIONS_SOURCES)
add_library(boost_program_options ${BOOST_LINK_TYPE} ${PROGRAM_OPTIONS_SOURCES})
##add_additional_library_path(boost_program_options)

target_include_directories(boost_program_options
    PUBLIC $<INSTALL_INTERFACE:include>
    PUBLIC $<BUILD_INTERFACE:${CMAKE_CURRENT_SOURCE_DIR}>
)

set_target_properties(boost_program_options PROPERTIES
    POSITION_INDEPENDENT_CODE ON
)

target_compile_definitions(boost_program_options PUBLIC "BOOST_PROGRAM_OPTIONS_${BOOST_DEFINE_SUFFIX}")

set_property(TARGET boost_program_options PROPERTY FOLDER "Externals//Boost")
list(APPEND PACKAGE_TARGETS "boost_program_options")
